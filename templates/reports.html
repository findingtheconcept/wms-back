<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отчеты - Warehouse Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Warehouse Manager</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Товары</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="operations_log.html">Операции</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="reports.html">Отчеты</a>
                    </li>
                     <li class="nav-item">
                        <a class="nav-link" href="categories.html">Категории</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="login.html">Выход</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        Формирование отчета
                    </div>
                    <div class="card-body">
                        <form id="reportForm">
                            <div class="mb-3">
                                <label for="reportType" class="form-label">Тип отчета:</label>
                                <select class="form-select" id="reportType" required>
                                    <option selected disabled value="">Выберите тип отчета...</option>
                                    <option value="current_stock_all">Текущие остатки всех товаров</option>
                                    <option value="low_stock">Товары с остатком ниже минимального</option>
                                    <option value="operations_period">Операции за выбранный период</option>
                                    <option value="product_movement_period">Движение конкретного товара за период</option>
                                </select>
                            </div>

                            <div id="conditionalInputsContainer">
                                </div>

                            <button type="submit" class="btn btn-primary w-100 mt-3"><i class="bi bi-bar-chart-line-fill me-2"></i>Сформировать отчет</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header">
                        Результаты отчета
                    </div>
                    <div class="card-body">
                        <div id="reportResultsArea" class="text-center p-5">
                            <p class="text-muted">Выберите тип отчета и нажмите 'Сформировать'.</p>
                            </div>
                        <div class="mt-3 text-end" id="exportButtons" style="display: none;">
                             <button class="btn btn-success btn-sm me-2"><i class="bi bi-file-earmark-excel-fill me-2"></i>Экспорт в CSV</button>
                             <button class="btn btn-danger btn-sm"><i class="bi bi-file-earmark-pdf-fill me-2"></i>Экспорт в PDF</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        const reportTypeSelect = document.getElementById('reportType');
        const conditionalInputsContainer = document.getElementById('conditionalInputsContainer');
        const reportForm = document.getElementById('reportForm');
        const reportResultsArea = document.getElementById('reportResultsArea');
        const exportButtons = document.getElementById('exportButtons');
        // const sampleReportTable = document.getElementById('sampleReportTable'); // Для примера

        reportTypeSelect.addEventListener('change', function() {
            conditionalInputsContainer.innerHTML = ''; // Очищаем предыдущие инпуты
            const selectedType = this.value;

            if (selectedType === 'operations_period' || selectedType === 'product_movement_period') {
                conditionalInputsContainer.innerHTML = `
                    <div class="mb-3">
                        <label for="reportStartDate" class="form-label">Период с:</label>
                        <input type="date" class="form-control form-control-sm" id="reportStartDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="reportEndDate" class="form-label">Период по:</label>
                        <input type="date" class="form-control form-control-sm" id="reportEndDate" required>
                    </div>
                `;
            }

            if (selectedType === 'product_movement_period') {
                conditionalInputsContainer.innerHTML += `
                    <div class="mb-3">
                        <label for="reportProductSelect" class="form-label">Выберите товар:</label>
                        <select class="form-select form-select-sm" id="reportProductSelect" required>
                            <option selected disabled value="">Выберите товар...</option>
                            <option value="1">Ноутбук ProBook 15</option>
                            <option value="2">Цемент M500</option>
                            <option value="3">Мука пшеничная</option>
                            <option value="4">Смартфон Galaxy S24</option>
                            </select>
                    </div>
                `;
            }
        });

        reportForm.addEventListener('submit', function(event) {
            event.preventDefault();
            // Здесь будет логика формирования отчета
            // Для примера, просто покажем текстовое сообщение и кнопки экспорта
            reportResultsArea.innerHTML = `<p class="text-success p-3">Отчет успешно сформирован (здесь будут данные отчета в виде таблицы или графика).</p>
            <div class="table-responsive mt-3" id="sampleReportTable">
                                <h6 class="text-start">Пример: Текущие остатки</h6>
                                <table class="table table-sm table-bordered table-striped">
                                    <thead>
                                        <tr><th>Наименование</th><th>Категория</th><th>Мин. ост.</th><th>Текущий ост.</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>Ноутбук ProBook 15</td><td>Электроника</td><td>5</td><td>12</td></tr>
                                        <tr><td>Цемент M500</td><td>Строительные материалы</td><td>100</td><td>500</td></tr>
                                        <tr><td>Мука пшеничная</td><td>Продукты питания</td><td>50</td><td>25</td></tr>
                                        <tr><td>Смартфон Galaxy S24</td><td>Электроника</td><td>10</td><td>8</td></tr>
                                    </tbody>
                                </table>
                            </div>
            `;
            // sampleReportTable.style.display = 'block'; // Показать пример таблицы
            exportButtons.style.display = 'block';
        });
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
</body>
</html>